<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="grates">
<title>Introduction â€¢ grates</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="grates">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">grates</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.9.9.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/grates.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/reconverse/grates/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/reconverse/grates/blob/HEAD/vignettes/grates.Rmd" class="external-link"><code>vignettes/grates.Rmd</code></a></small>
      <div class="d-none name"><code>grates.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of grates is to make it easy to group dates across a range
of different time intervals. It defines a collection of classes and
associated methods that, together, formalise the concept of grouped
dates and are intuitive to use. To assist in formatting plots of grates
objects we also provides x-axis scales that can be used in conjunction
with <a href="https://cran.r-project.org/package=ggplot2" class="external-link">ggplot2</a>
output. Currently implemented classes are:</p>
<ul>
<li><p><a href="#yearweek">grates_yearweek</a>;</p></li>
<li><p><a href="#yearweek">grates_epiweek</a>;</p></li>
<li><p><a href="#yearweek">grates_isoweek</a>;</p></li>
<li><p><a href="#period">grates_period</a>;</p></li>
<li><p><a href="#yearxxx">grates_yearmonth</a>;</p></li>
<li><p><a href="#yearxxx">grates_yearquarter</a>;</p></li>
<li><p><a href="#yearxxx">grates_year</a>; and</p></li>
<li><p><a href="#month">grates_month</a></p></li>
</ul>
<p>The underlying implementation for these objects build upon ideas of
Davis Vaughan and the unreleased <a href="https://github.com/DavisVaughan/datea/" class="external-link">datea</a> package as well
as Zhian Kamvar and the <a href="https://cran.r-project.org/package=aweek" class="external-link">aweek</a> package.</p>
</div>
<div class="section level2">
<h2 id="grates-objects">grates objects<a class="anchor" aria-label="anchor" href="#grates-objects"></a>
</h2>
<div class="section level3">
<h3 id="yearweek">yearweek, epiweek and isoweek<a class="anchor" aria-label="anchor" href="#yearweek"></a>
</h3>
<p><strong>yearweek</strong> objects are stored as the number of weeks
(starting at 0L) from the date of the <code>firstday</code> nearest the
Unix Epoch (1970-01-01). Put more simply, the number of seven day
periods from:</p>
<ul>
<li>1969-12-29 for <code>firstday</code> equal to 1 (Monday)</li>
<li>1969-12-30 for <code>firstday</code> equal to 2 (Tuesday)</li>
<li>1969-12-31 for <code>firstday</code> equal to 3 (Wednesday)</li>
<li>1970-01-01 for <code>firstday</code> equal to 4 (Thursday)</li>
<li>1970-01-02 for <code>firstday</code> equal to 5 (Friday)</li>
<li>1970-01-03 for <code>firstday</code> equal to 6 (Saturday)</li>
<li>1970-01-04 for <code>firstday</code> equal to 7 (Sunday)</li>
</ul>
<p>They can be constructed directly from integers via the
<code><a href="../reference/new_yearweek.html">new_yearweek()</a></code> function but it is generally easier to use
the <code><a href="../reference/as_yearweek.html">as_yearweek()</a></code> generic. <code><a href="../reference/as_yearweek.html">as_yearweek()</a></code> takes
two arguments; <code>x</code>, the vector (normally a Date or POSIXt)
you wish to group, and <code>firstday</code>, the day of the week you
wish your weeks to start on.</p>
<p>The <strong>epiweek</strong> class is similar to the yearweek class
but, by definition, will always begin on a Sunday. They are stored as
the integer number of weeks (again starting at 0L) since 1970-01-04 so
internally are akin to <code>&lt;grates_yearweek_sunday&gt;</code>
objects but with the benefit of slightly more efficient implementations
for many of the associated methods.</p>
<p>Likewise, the <strong>isoweek</strong> class is similar to epiweek
class but uses the <a href="https://en.wikipedia.org/wiki/ISO_week_date" class="external-link">ISO 8601</a>
definition of a week that will always start on a Monday. Internally they
are stored as the integer number of weeks since 1969-12-29.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.reconverse.org/grates/" class="external-link">grates</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Choose some consecutive dates that begin on a Friday</span></span>
<span><span class="va">first</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="va">first</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Friday"</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="va">first</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span></span>
<span></span>
<span><span class="co"># Below we use a Friday-week grouping (firstday = 5)</span></span>
<span><span class="va">weeks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_yearweek.html">as_yearweek</a></span><span class="op">(</span><span class="va">dates</span>, firstday <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dates</span>, <span class="va">weeks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         dates    weeks</span></span>
<span><span class="co">#&gt; 1  2021-01-01 2021-W01</span></span>
<span><span class="co">#&gt; 2  2021-01-02 2021-W01</span></span>
<span><span class="co">#&gt; 3  2021-01-03 2021-W01</span></span>
<span><span class="co">#&gt; 4  2021-01-04 2021-W01</span></span>
<span><span class="co">#&gt; 5  2021-01-05 2021-W01</span></span>
<span><span class="co">#&gt; 6  2021-01-06 2021-W01</span></span>
<span><span class="co">#&gt; 7  2021-01-07 2021-W01</span></span>
<span><span class="co">#&gt; 8  2021-01-08 2021-W02</span></span>
<span><span class="co">#&gt; 9  2021-01-09 2021-W02</span></span>
<span><span class="co">#&gt; 10 2021-01-10 2021-W02</span></span>
<span></span>
<span><span class="co"># epiweeks always start on a Sunday</span></span>
<span><span class="op">(</span><span class="va">epiwk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_epiweek.html">as_epiweek</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_epiweek[1]&gt;</span></span>
<span><span class="co">#&gt; [1] "2022-W46"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">epiwk</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Sunday"</span></span>
<span></span>
<span><span class="co"># isoweeks always start on a Sunday</span></span>
<span><span class="op">(</span><span class="va">isowk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_isoweek.html">as_isoweek</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_isoweek[1]&gt;</span></span>
<span><span class="co">#&gt; [1] "2022-W46"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">isowk</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Monday"</span></span></code></pre></div>
<p>By default plots (using ggplot2) will centre yearweek (epiweek /
isoweek) labels:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use simulated linelist data from the outbreaks package</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">outbreaks</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/outbreaks/man/ebola_sim.html" class="external-link">ebola_sim_clean</a></span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_of_infection</span></span>
<span></span>
<span><span class="co"># calculate the total number for across each week</span></span>
<span><span class="va">week_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="../reference/as_epiweek.html">as_epiweek</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">length</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">week_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;       week cases</span></span>
<span><span class="co">#&gt; 1 2014-W12     1</span></span>
<span><span class="co">#&gt; 2 2014-W15     1</span></span>
<span><span class="co">#&gt; 3 2014-W16     1</span></span>
<span><span class="co">#&gt; 4 2014-W17     3</span></span>
<span><span class="co">#&gt; 5 2014-W18     6</span></span>
<span><span class="co">#&gt; 6 2014-W19    16</span></span>
<span></span>
<span><span class="co"># plot the output</span></span>
<span><span class="op">(</span><span class="va">week_plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">week_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">week</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can have non-centred date labels on the x_axis by utilising the
associated scale_x_grates functions and explicitly specifying a format
for the date labels:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">week_plot</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_x_grates_epiweek.html">scale_x_grates_epiweek</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="period">Period<a class="anchor" aria-label="anchor" href="#period"></a>
</h3>
<p><strong>period</strong> objects are stored as the integer number,
starting at 0L, of periods since the Unix Epoch (1970-01-01) and a
specified offset. Here periods are taken to mean groupings of
<code>n</code> consecutive days.</p>
<p>Like with yearweek objects, period objects can be constructed
directly via a call to <code><a href="../reference/new_period.html">new_period()</a></code> but more easily via the
<code><a href="../reference/as_period.html">as_period()</a></code> coercion function. <code><a href="../reference/as_period.html">as_period()</a></code>
takes 3 arguments; <code>x</code>, the vector (normally a Date or
POSIXt) you wish to group, <code>n</code>, the integer number of days
you wish to group, and <code>offset</code>, the value you wish to start
counting groups from relative to the Unix Epoch. For convenience,
<code>offset</code> can be given as a date you want periods to be
relative to (internally this date is converted to integer).</p>
<p>Note that storage and calculation purposes, <code>offset</code> is
scaled relative to <code>n</code>. I.e.
<code>offset &lt;- offset %% n</code> and values of <code>x</code>
stored relative to this scaled offset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the total number for across 14 day periods with no offset.</span></span>
<span><span class="co"># note - 0L is the default value for the offset but we specify it explicitly</span></span>
<span><span class="co"># here for added clarity</span></span>
<span><span class="va">period_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>period <span class="op">=</span> <span class="fu"><a href="../reference/as_period.html">as_period</a></span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">14L</span>, offset <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">length</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">period_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     period cases</span></span>
<span><span class="co">#&gt; 1 2014-03-13 to 2014-03-26     1</span></span>
<span><span class="co">#&gt; 2 2014-03-27 to 2014-04-09     1</span></span>
<span><span class="co">#&gt; 3 2014-04-10 to 2014-04-23     3</span></span>
<span><span class="co">#&gt; 4 2014-04-24 to 2014-05-07    19</span></span>
<span><span class="co">#&gt; 5 2014-05-08 to 2014-05-21    19</span></span>
<span><span class="co">#&gt; 6 2014-05-22 to 2014-06-04    30</span></span>
<span></span>
<span><span class="co"># lower date bounds are used for the x axis</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">period_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span> <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># using a date as an offset</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-03"</span><span class="op">)</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span></span>
<span><span class="va">offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dates</span>, period <span class="op">=</span> <span class="fu"><a href="../reference/as_period.html">as_period</a></span><span class="op">(</span><span class="va">dates</span>, n <span class="op">=</span> <span class="fl">7L</span>, offset <span class="op">=</span> <span class="va">offset</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         dates                   period</span></span>
<span><span class="co">#&gt; 1  2020-01-03 2020-01-01 to 2020-01-07</span></span>
<span><span class="co">#&gt; 2  2020-01-04 2020-01-01 to 2020-01-07</span></span>
<span><span class="co">#&gt; 3  2020-01-05 2020-01-01 to 2020-01-07</span></span>
<span><span class="co">#&gt; 4  2020-01-06 2020-01-01 to 2020-01-07</span></span>
<span><span class="co">#&gt; 5  2020-01-07 2020-01-01 to 2020-01-07</span></span>
<span><span class="co">#&gt; 6  2020-01-08 2020-01-08 to 2020-01-14</span></span>
<span><span class="co">#&gt; 7  2020-01-09 2020-01-08 to 2020-01-14</span></span>
<span><span class="co">#&gt; 8  2020-01-10 2020-01-08 to 2020-01-14</span></span>
<span><span class="co">#&gt; 9  2020-01-11 2020-01-08 to 2020-01-14</span></span>
<span><span class="co">#&gt; 10 2020-01-12 2020-01-08 to 2020-01-14</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="yearxxx">yearmonth, yearquarter and year<a class="anchor" aria-label="anchor" href="#yearxxx"></a>
</h3>
<p><strong>yearmonth</strong>, <strong>yearquarter</strong> and
<strong>year</strong> objects are stored as the integer number of
months/quarters/years (starting at 0L) since the Unix Epoch
(1970-01-01).</p>
<p>As with all grates objects they they can be constructed directly from
integers via the <code><a href="../reference/new_yearmonth.html">new_yearmonth()</a></code>,
<code><a href="../reference/new_yearquarter.html">new_yearquarter()</a></code> and <code><a href="../reference/year.html">year()</a></code> functions but it
is often easier to use the <code><a href="../reference/as_yearmonth.html">as_yearmonth()</a></code>,
<code><a href="../reference/as_yearquarter.html">as_yearquarter()</a></code> and <code><a href="../reference/as_year.html">as_year()</a></code> coercion
functions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the monthly number of cases</span></span>
<span><span class="op">(</span><span class="va">month_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="../reference/as_yearmonth.html">as_yearmonth</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">length</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       month cases</span></span>
<span><span class="co">#&gt; 1  2014-Mar     1</span></span>
<span><span class="co">#&gt; 2  2014-Apr     6</span></span>
<span><span class="co">#&gt; 3  2014-May    57</span></span>
<span><span class="co">#&gt; 4  2014-Jun    80</span></span>
<span><span class="co">#&gt; 5  2014-Jul   183</span></span>
<span><span class="co">#&gt; 6  2014-Aug   453</span></span>
<span><span class="co">#&gt; 7  2014-Sep   813</span></span>
<span><span class="co">#&gt; 8  2014-Oct   719</span></span>
<span><span class="co">#&gt; 9  2014-Nov   448</span></span>
<span><span class="co">#&gt; 10 2014-Dec   307</span></span>
<span><span class="co">#&gt; 11 2015-Jan   251</span></span>
<span><span class="co">#&gt; 12 2015-Feb   199</span></span>
<span><span class="co">#&gt; 13 2015-Mar   152</span></span>
<span><span class="co">#&gt; 14 2015-Apr    73</span></span>
<span></span>
<span><span class="co"># plot with centred labels</span></span>
<span><span class="op">(</span><span class="va">month_plot</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">month_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># again we can have non-centred date labels by applying the associated scale</span></span>
<span><span class="va">month_plot</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_x_grates_yearmonth.html">scale_x_grates_yearmonth</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># yearquarter works similarly</span></span>
<span><span class="op">(</span><span class="va">quarter_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>quarter <span class="op">=</span> <span class="fu"><a href="../reference/as_yearquarter.html">as_yearquarter</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">length</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   quarter cases</span></span>
<span><span class="co">#&gt; 1 2014-Q1     1</span></span>
<span><span class="co">#&gt; 2 2014-Q2   143</span></span>
<span><span class="co">#&gt; 3 2014-Q3  1449</span></span>
<span><span class="co">#&gt; 4 2014-Q4  1474</span></span>
<span><span class="co">#&gt; 5 2015-Q1   602</span></span>
<span><span class="co">#&gt; 6 2015-Q2    73</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">quarter_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">quarter</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># year also works similarly</span></span>
<span><span class="op">(</span><span class="va">year_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="../reference/as_year.html">as_year</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">length</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year cases</span></span>
<span><span class="co">#&gt; 1 2014  3067</span></span>
<span><span class="co">#&gt; 2 2015   675</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">year_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-6-4.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="month">month<a class="anchor" aria-label="anchor" href="#month"></a>
</h3>
<p><strong>month</strong> objects are stored as the integer number of
n-month groups (starting at 0L) since the Unix Epoch (1970-01-01). Here
n-months is taken to mean a â€˜grouping of n consecutive monthsâ€™.</p>
<p><code>&lt;grates_month&gt;</code> objects can be constructed directly
from integers via the <code><a href="../reference/new_month.html">new_month()</a></code> function and through
coercion via the <code><a href="../reference/as_month.html">as_month()</a></code> function.
<code><a href="../reference/as_period.html">as_period()</a></code> takes 2 arguments; <code>x</code>, the vector
(normally a Date or POSIXt) you wish to group, <code>n</code>, the
integer number of months you wish to group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the bimonthly number of cases</span></span>
<span><span class="op">(</span><span class="va">bimonth_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="../reference/as_month.html">as_month</a></span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">length</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  group cases</span></span>
<span><span class="co">#&gt; 1 2014-Mar to 2014-Apr     7</span></span>
<span><span class="co">#&gt; 2 2014-May to 2014-Jun   137</span></span>
<span><span class="co">#&gt; 3 2014-Jul to 2014-Aug   636</span></span>
<span><span class="co">#&gt; 4 2014-Sep to 2014-Oct  1532</span></span>
<span><span class="co">#&gt; 5 2014-Nov to 2014-Dec   755</span></span>
<span><span class="co">#&gt; 6 2015-Jan to 2015-Feb   450</span></span>
<span><span class="co">#&gt; 7 2015-Mar to 2015-Apr   225</span></span>
<span></span>
<span><span class="co"># by default lower date bounds are used for the x axis</span></span>
<span><span class="op">(</span><span class="va">bimonth_plot</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bimonth_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that the default plotting behaviour of non-centred date labels
is different to that of the yearweek, yearmonth, yearquarter and year
scales where labels are centred by default. To obtain centred labels you
must explicitly set the format to NULL in the scale:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">month_plot</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_x_grates_yearmonth.html">scale_x_grates_yearmonth</a></span><span class="op">(</span>format <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="grates_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="methods-and-operations">Methods and operations<a class="anchor" aria-label="anchor" href="#methods-and-operations"></a>
</h2>
<p>For all <code>grates</code> objects we have added many methods and
operations to ensure logical and consistent behaviour. Where things
break down we try to provide detailed messaging explaining why errors
have occurred. Whilst this behviour is implemented for all grates
objects, below we illustrate how it manifests with epiweek objects.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the unique epiweeks from the earlier example</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">week_dat</span><span class="op">$</span><span class="va">week</span></span>
<span></span>
<span><span class="co"># min, max and range</span></span>
<span><span class="op">(</span><span class="va">minx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_epiweek[1]&gt;</span></span>
<span><span class="co">#&gt; [1] "2014-W12"</span></span>
<span><span class="op">(</span><span class="va">maxx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_epiweek[1]&gt;</span></span>
<span><span class="co">#&gt; [1] "2015-W17"</span></span>
<span><span class="va">rangex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># seq method works if both `from` and `to` are epiweeks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">minx</span>, to <span class="op">=</span> <span class="va">maxx</span>, by <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_epiweek[10]&gt;</span></span>
<span><span class="co">#&gt;  [1] "2014-W12" "2014-W18" "2014-W24" "2014-W30" "2014-W36" "2014-W42"</span></span>
<span><span class="co">#&gt;  [7] "2014-W48" "2015-W01" "2015-W07" "2015-W13"</span></span>
<span></span>
<span><span class="co"># but will error informatively if `to` is a different class</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">minx</span>, to <span class="op">=</span> <span class="fl">999</span>, by <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in seq.grates_epiweek(from = minx, to = 999, by = 6L) : </span></span>
<span><span class="co">#&gt;   `to` must be a &lt;grates_epiweek&gt; object of length 1.</span></span>
<span></span>
<span><span class="co"># conversion of yearweek objects back to dates will return the date at the</span></span>
<span><span class="co"># lower bound of each yearweek interval</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">week_dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, new_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       week cases   new_date</span></span>
<span><span class="co">#&gt; 1 2014-W12     1 2014-03-16</span></span>
<span><span class="co">#&gt; 2 2014-W15     1 2014-04-06</span></span>
<span><span class="co">#&gt; 3 2014-W16     1 2014-04-13</span></span>
<span><span class="co">#&gt; 4 2014-W17     3 2014-04-20</span></span>
<span><span class="co">#&gt; 5 2014-W18     6 2014-04-27</span></span>
<span><span class="co">#&gt; 6 2014-W19    16 2014-05-04</span></span>
<span></span>
<span><span class="co"># addition (subtraction) of wholenumbers will add (subtract) the corresponding</span></span>
<span><span class="co"># number of weeks to (from) the object</span></span>
<span><span class="op">(</span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, plus4 <span class="op">=</span> <span class="va">week</span> <span class="op">+</span> <span class="fl">4L</span>, minus4 <span class="op">=</span> <span class="va">week</span> <span class="op">-</span> <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       week cases    plus4   minus4</span></span>
<span><span class="co">#&gt; 1 2014-W12     1 2014-W16 2014-W08</span></span>
<span><span class="co">#&gt; 2 2014-W15     1 2014-W19 2014-W11</span></span>
<span><span class="co">#&gt; 3 2014-W16     1 2014-W20 2014-W12</span></span>
<span><span class="co">#&gt; 4 2014-W17     3 2014-W21 2014-W13</span></span>
<span><span class="co">#&gt; 5 2014-W18     6 2014-W22 2014-W14</span></span>
<span><span class="co">#&gt; 6 2014-W19    16 2014-W23 2014-W15</span></span>
<span></span>
<span><span class="co"># addition of two yearweek objects will error as the intention is unclear</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, willerror <span class="op">=</span> <span class="va">week</span> <span class="op">+</span> <span class="va">week</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in Ops.grates_epiweek(week, week) : </span></span>
<span><span class="co">#&gt;   Cannot add &lt;grates_epiweek&gt; objects to each other.</span></span>
<span></span>
<span><span class="co"># Subtraction of two yearweek objects gives the difference in weeks between them</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, difference <span class="op">=</span> <span class="va">plus4</span> <span class="op">-</span> <span class="va">minus4</span><span class="op">)</span></span>
<span><span class="co">#&gt;       week cases    plus4   minus4 difference</span></span>
<span><span class="co">#&gt; 1 2014-W12     1 2014-W16 2014-W08    8 weeks</span></span>
<span><span class="co">#&gt; 2 2014-W15     1 2014-W19 2014-W11    8 weeks</span></span>
<span><span class="co">#&gt; 3 2014-W16     1 2014-W20 2014-W12    8 weeks</span></span>
<span><span class="co">#&gt; 4 2014-W17     3 2014-W21 2014-W13    8 weeks</span></span>
<span><span class="co">#&gt; 5 2014-W18     6 2014-W22 2014-W14    8 weeks</span></span>
<span><span class="co">#&gt; 6 2014-W19    16 2014-W23 2014-W15    8 weeks</span></span>
<span></span>
<span><span class="co"># epiweeks can be combined with themselves but not other classes (assuming an</span></span>
<span><span class="co"># epiweek object is the first entry)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">minx</span>, <span class="va">maxx</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;grates_epiweek[2]&gt;</span></span>
<span><span class="co">#&gt; [1] "2014-W12" "2015-W17"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">minx</span>, <span class="va">maxx</span><span class="op">)</span>, <span class="va">rangex</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">minx</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in c.grates_epiweek(minx, 1L) : </span></span>
<span><span class="co">#&gt;   Unable to combine &lt;grates_epiweek&gt; objects with other classes.</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tim Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
